---
title: "EV Power - Lab 4 Project Report"
format: typst
---

# Example Solution 1

## **Part 0: libraries**

```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(tibble)
library(stringr)
library(tidyr)
```

## **Part 1:** **Defining Research Question**

Chosen Question: Does investing in renewable engery lead to the a lowering of energy costs?

## **Part 2: Data Preparation and Cleaning**

```{r}
# Load in necessary csv files
avg_price_2021_2023 <- read.csv("data/av-energy-price-2021-2023.csv", stringsAsFactors = FALSE)
renew_use_2021 <-read.csv("data/renew-use-2021.csv")
renew_use_2022 <- read.csv("data/renew-use-2022.csv")
renew_use_2023 <- read.csv("data/renew-use-2023.csv")

# Clean avg_price_2021_2023

## Remove all unwanted characters and symbols. 
clean_price <- function(x) {
    x <- gsub("per MMBtu", "", x, ignore.case = TRUE)
    x <- gsub("about", "", x, ignore.case = TRUE)
    x <- gsub("â‰ˆ","",x)
    x <- gsub("\\$","",x)
    x <- gsub("usd","",x, ignore.case = TRUE)
    x <- gsub("est","",x,ignore.case=TRUE)
    x <- gsub(" ","",x)
    x <- gsub("\\.$","",x)
    x <- gsub("MMBtu","",x)
    x <- gsub("~","",x)
    x <- gsub("kwh","", x, ignore.case = TRUE)
    x <- gsub("mwh","",x, ignore.case = TRUE)
}

avg_price_2021_2023 <- clean_price(avg_price_2021_2023$Total.energy.average.price..dollars.per.million.Btu...)

avg_price_2021_2023 <-data.frame(avg_price_2021_2023)

## Seperate every states estimated price by year.
avg_price <- avg_price_2021_2023
avg_price <- avg_price |>
    slice(-1:-2) |>
    mutate(State = str_extract(avg_price_2021_2023, "^[A-Z]{2}"),
            `2021` = str_sub(avg_price_2021_2023, 4, 8),
            `2022` = str_sub(avg_price_2021_2023, 10, 14),
            `2023` = str_sub(avg_price_2021_2023, 16, 20))

avg_price <- avg_price |>
    select(2:5)

# Clean renew_use_2021

Use_2021 <- clean_price(renew_use_2021$Renewable_Use_2021)

renew_use_2021$Renewable_Use_2021 <- Use_2021

# Clean renew_use_2022

Use_2022 <- clean_price(renew_use_2022$Renewable_Use_2022)

renew_use_2022$Renewable_Use_2022 <- Use_2022

# Clean renew_use 2023

Use_2023 <- clean_price(renew_use_2023$Renewable_Use_2023)

renew_use_2023$Renewable_Use_2023 <- Use_2023

```

## **Part 3: Joining / Pivoting Datasets for Analysis**

```{r}
# Pivoting Renew Use Data Sets

clean_2021 <- pivot_wider(renew_use_2021,
            names_from = Energy_Source,
            values_from = Renewable_Use_2021)

clean_2022 <-pivot_wider(renew_use_2022,
            names_from = Energy_Source,
            values_from = Renewable_Use_2022)

clean_2023 <- pivot_wider(renew_use_2023,
            names_from = Energy_Source,
            values_from = Renewable_Use_2023)

```

## **Part 4: Mapping Visualization**

```{r}

```